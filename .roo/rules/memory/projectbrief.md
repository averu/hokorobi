# 設計支援対話アプリ プロジェクト概要

## 目的

このプロジェクトの目的は、**要件定義、基本設計、詳細設計のフローを手助けする対話型アプリ**を開発することを通じて、React アプリケーション開発における堅牢な開発プラクティスを確立し、特に以下の点に重点を置いた知識を蓄積することです：

1. TypeScript による厳格な型定義の活用
2. テスト駆動開発（TDD）の原則に基づいた開発プロセス
3. **効果的な対話型 UI の構築と状態管理**
4. AI 支援コーディングとの効果的な連携方法（特に設計支援の文脈で）

## コア目標

- **型安全性の最大化**: TypeScript の高度な型システムを活用して、実行時エラーを開発時に捕捉する
- **テストファーストの原則**: すべての機能実装の前にテストを書き、Red-Green-Refactor サイクルを徹底する
- **対話型 UI コンポーネントの設計**: ユーザーが設計フローをスムーズに進められるような、直感的で再利用可能な UI コンポーネントを構築する
- **状態管理の最適化**: 設計フローの各段階の状態（要件、設計要素、関連情報など）を効率的に管理する
- **AI との協働ワークフロー**: 設計プロセスを支援するための AI 機能（提案、要約、検証など）を統合するプラクティスの確立
- **知識の体系化**: 発見したパターンやベストプラクティスの継続的な記録と改善

## プロジェクト範囲

### 技術スタック

- React 18+
- TypeScript 5.0+
- Vitest + React Testing Library
- MSW (Mock Service Worker)
- React Query / TanStack Query (データ永続化に API を使用する場合)
- Zod (スキーマ検証)
- Jotai (状態管理): シンプルな API、アトミックな状態管理によるパフォーマンス最適化、TypeScript との親和性の高さを評価し選定

### 実装対象

1. **対話インターフェース**:
   - ユーザーからのテキスト入力受付
   - アプリからの応答（テキスト、選択肢など）表示
   - 会話履歴の表示
2. **設計フロー管理**:
   - 要件定義、基本設計、詳細設計のステップ管理
   - 各ステップでのガイドや質問提示
   - フローの進行状況の可視化
3. **データ管理**:
   - 設計プロセスで生成された情報（要件リスト、設計項目、決定事項など）の構造化データ管理
   - 状態の永続化（例: ローカルストレージ、将来的には API 連携）
4. **UI コンポーネントライブラリ**:
   - 対話表示用コンポーネント (メッセージバブル等)
   - 入力用コンポーネント (テキストエリア、選択肢ボタン等)
   - フロー表示用コンポーネント (ステップインジケーター等)
   - 共通レイアウトコンポーネント
5. **状態管理**:
   - 現在の設計フェーズ、ユーザー入力、生成された設計データ、会話履歴などの状態管理 (Jotai)
6. **(将来)** **AI 連携モジュール**:
   - 設計に関する提案生成
   - 入力内容の要約・整理
   - 設計内容の検証支援

## 開発アプローチ

### テスト駆動開発（TDD）サイクル

すべての機能開発は以下の TDD サイクルに従います：

1. **Red**: 失敗するテストを書く
   - 機能要件を明確に理解
   - 期待される動作を検証するテストを作成
   - テストが失敗することを確認
2. **Green**: 最小限のコードでテストを通過させる
   - 機能を実装するための最小限のコードを書く
   - テストが通過することを確認
   - この段階では実装の美しさより機能性を優先
3. **Refactor**: コードを改善する
   - コードの質と可読性を向上させる
   - パフォーマンスを最適化する
   - テストが引き続き通過することを確認

### TypeScript 型定義のベストプラクティス

- **API レスポンス型**: (API 利用時) バックエンドから返されるデータの型を厳密に定義
- **コンポーネント Props**: すべての React コンポーネントの props に明示的な型を定義
- **状態管理**: アプリケーション状態（設計データ、UI 状態）に関する型を定義
- **ユーティリティ型**: TypeScript の高度な型機能を活用したユーティリティ型の作成
- **Zod スキーマ**: 実行時のデータ検証（特に外部入力や永続化データ）のための Zod スキーマと TypeScript の型の連携

### AI 支援コーディングのワークフロー

1. テスト仕様の作成（人間）
2. テストコードの生成サポート（AI）
3. 実装案の提案（AI）
4. コードレビューと改善（人間と AI の協働）
5. リファクタリングの提案（AI）
6. ドキュメンテーション（AI 支援）

### コンポーネント命名規則

コンポーネントの命名は、コードの可読性と保守性を高める上で重要です。以下のベストプラクティスに従います：

- **PascalCase**: コンポーネント名は常に PascalCase で記述します (例: `ChatBubble`, `DesignStepIndicator`)。
- **明確な名前**: コンポーネントの役割や目的が一目でわかるような、具体的で明確な名前を付けます (例: `RequirementInput`, `ConfirmationDialog`)。
- **ファイル名との一致**: コンポーネントを定義するファイル名は、コンポーネント名と一致させます (例: `ChatInput.tsx` には `ChatInput` コンポーネント)。
- **ディレクトリ構造との連携**: コンポーネントの配置場所（例: `components/Chat`, `features/requirement-definition/components`）と関連付け、一貫性を保ちます。
- **一貫性**: プロジェクト全体で命名規則の一貫性を維持します。

### エラーハンドリング方針

アプリケーションの堅牢性を高めるため、統一されたエラーハンドリング方針を定めます。

- **API エラー**: (API 利用時)
  - データ取得/更新に関するエラーは、主に React Query (TanStack Query) の組み込みエラーハンドリング機能を活用します。
  - 必要に応じて、共通のエラー処理ロジックをカスタムフックに抽出し、再利用性を高めます。
- **UI エラー**:
  - ユーザー操作に起因するエラー（例: 不正な入力）や、アプリ内部処理のエラーをユーザーに通知する必要がある場合は、インラインメッセージや通知コンポーネントで適切にフィードバックを提供します。
- **予期せぬエラー**:
  - コンポーネントツリーの特定の部分で発生した JavaScript エラーがアプリケーション全体をクラッシュさせないように、React の Error Boundary を適切に配置します。Error Boundary はフォールバック UI を表示し、エラー情報を記録します。
- **エラーログ**:
  - 開発環境では、詳細なエラー情報をコンソールに出力します。
  - 本番環境では、Sentry などの外部エラー監視サービスと連携し、エラーの追跡、分析、デバッグを効率化することを推奨します。
- **型安全性**:
  - TypeScript を活用し、API レスポンスのエラー形式や、カスタムエラーオブジェクトの型を定義することで、エラーハンドリング処理の型安全性を確保します。

### コードスタイルと静的解析

コードの一貫性を保ち、潜在的な問題を早期に発見するために、以下のツールと設定を導入します。

- **コードフォーマッター (Prettier)**:
  - プロジェクト全体で統一されたコードスタイルを強制するために Prettier を使用します。
  - 設定は `.prettierrc` ファイル（または `package.json` 内）で管理します。
- **リンター (ESLint)**:
  - コードの品質を維持し、バグを未然に防ぐために ESLint を使用します。
  - TypeScript (`@typescript-eslint/eslint-plugin`)、React (`eslint-plugin-react`, `eslint-plugin-react-hooks`)、アクセシビリティ (`eslint-plugin-jsx-a11y`) など、関連するプラグインと推奨ルールセットを活用します。
  - 設定は `eslint.config.js` ファイル（または `.eslintrc.*`）で管理します。
- **自動化**:
  - コミット前に自動的にフォーマットとリントチェックを実行するために、husky と lint-staged の導入を推奨します。これにより、リポジトリにコミットされるコードの品質を一定に保ちます。

## 評価指標

- テストカバレッジ: 80%以上
- 型エラーの発生率
- コンポーネント再利用率
- AI 提案の採用率とその効果 (将来的な AI 連携実装後)
- バグ発生率の低減
- **ユーザーフィードバック**: 設計フロー支援の有効性に関するフィードバック

## 期待される成果物

1. **設計支援対話アプリのプロトタイプ/MVP**
2. **再利用可能な対話型 UI コンポーネントライブラリ**
3. TDD・型安全な React 開発のベストプラクティスドキュメント
4. AI 支援開発の効果的なプロンプトパターン集（設計支援タスクに特化）
5. アプリ開発プロセスに関するチュートリアルとサンプル実装

---

このプロジェクトを通じて、**効果的な設計支援対話アプリ**を構築するとともに、React、TypeScript、TDD の最新のベストプラクティスを体系化し、AI との協働による効率的な開発プロセスを確立することを目指します。
